<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>kaleidoscope_eye</title>


</head>
<body>
<script type="text/javascript" src="../../lib/browser/log.js"></script>

<script type="text/javascript">
    onload = function() {
        var img = document.createElement("img");
        img.onload = function() {
            var canvas = document.createElement("canvas");
            canvas.width = canvas.height = 300;
            document.body.appendChild(canvas);
            var ctx = canvas.getContext("2d");
            ctx.drawImage(img, 0, 0);

            var imageData = ctx.getImageData(0, 0, 300, 300);
            var data = imageData.data;
            for(var i = 0; i < data.length; i += 4) {
                var c = (data[i] * 0.299 + data[i + 1] * 0.587 + data[i + 2] * 0.114) | 0;
                data[i] = data[i + 1] = data[i + 2] = c;
            }
            ctx.putImageData(imageData, 0, 0);
        };
        img.src = "images/eye.png";
    };
</script>
</body>
</html>
